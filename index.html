<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <img src="images/logo.png" alt="Logo" class="logo">
    </header>

    <main id="scroll-container">
        <div class="scroll-wrapper">
            <div class="cases-title">
                <img src="images/txt_cases.png" alt="Cases">
            </div>

            <div class="portfolio-grid">
                <div class="case-container" onclick="openPopup('images/case_01_big.jpg')">
                    <img src="images/case_01_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Landing Future Loan</div>
                </div>

                <div class="case-container" onclick="openVideo('https://www.youtube.com/watch?v=4WKPimFrzy8')">
                    <img src="images/case_01_small.jpg" class="case-item"> 
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Промо-видео проекта</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_02_big.jpg')">
                    <img src="images/case_02_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Car Insurance Website</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_03_big.jpg')">
                    <img src="images/case_03_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">UI Android Loan App</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_04_big.jpg')">
                    <img src="images/case_04_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Website of Marketing Agency</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_05_big.jpg')">
                    <img src="images/case_05_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Data Sender Portal</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_06_big.jpg')">
                    <img src="images/case_06_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Furniture website</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_07_big.jpg')">
                    <img src="images/case_07_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Taxi App for Android</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_08_big.jpg')">
                    <img src="images/case_08_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Audio Editor App for Android</div>
                </div>
            </div>
        </div>
    </main>

    <div id="popup" class="popup" onclick="closePopup()">
    <div class="popup-content">
        <img id="popup-img" src="" alt="Full size" style="display: none;">
        <iframe id="popup-video" src="" frameborder="0" allowfullscreen style="display: none; width: 80vw; height: 45vw;"></iframe>
        </div>
    </div>

    <script>
        const slider = document.getElementById('scroll-container');
        let isDown = false;
        let startX;
        let scrollLeft;
        let isDragging = false; 

        // 1. Скролл колесиком
        slider.addEventListener('wheel', (evt) => {
            evt.preventDefault();
            slider.scrollLeft += evt.deltaY;
        });

        // 2. Зажатие кнопки мыши
        slider.addEventListener('mousedown', (e) => {
            isDown = true;
            isDragging = false; 
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
            slider.style.cursor = 'grabbing';
            slider.style.userSelect = 'none';
        });

        slider.addEventListener('mouseleave', () => {
            isDown = false;
            slider.style.cursor = 'grab';
        });

        slider.addEventListener('mouseup', () => {
            isDown = false;
            slider.style.cursor = 'grab';
            slider.style.userSelect = 'auto';
            // Не сбрасываем isDragging мгновенно, чтобы перехват клика успел отработать
            setTimeout(() => { isDragging = false; }, 10);
        });

        // 3. Движение мыши
        slider.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            
            const x = e.pageX - slider.offsetLeft;
            const walk = (x - startX) * 1;
            
            // Если сдвинули больше чем на 10 пикселей — это точно скролл, а не клик
            if (Math.abs(x - startX) > 10) {
                isDragging = true;
            }

            if (isDragging) {
                e.preventDefault();
                slider.scrollLeft = scrollLeft - walk;
            }
        });

        // 4. ГЛАВНЫЙ ПЕРЕХВАТ: Если был драг, клик не пройдет к картинкам
        slider.addEventListener('click', (e) => {
            if (isDragging) {
                e.stopImmediatePropagation();
                e.stopPropagation();
                e.preventDefault();
            }
        }, true); // Параметр true включает фазу захвата

        // 5. Функции Попапа
        function openPopup(src) {
            const popup = document.getElementById('popup');
            const popupImg = document.getElementById('popup-img');

            popupImg.src = ''; // Очистка старого кадра
            popupImg.src = src;

            popup.style.display = 'flex';
            popup.scrollTop = 0;
        }

        function closePopup() {
            document.getElementById('popup').style.display = 'none';
        }

        // Блокировка стандартного перетаскивания картинок браузером
        slider.querySelectorAll('img').forEach(img => {
            img.addEventListener('dragstart', (e) => e.preventDefault());
        });
    </script>
</body>
</html>
