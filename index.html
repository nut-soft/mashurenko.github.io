<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <img src="images/logo.png" alt="Logo" class="logo">
    </header>

    <main id="scroll-container">
        <div class="scroll-wrapper">
            <div class="cases-title">
                <img src="images/txt_cases.png" alt="Cases">
            </div>

            <div class="portfolio-grid">
                <div class="case-container" onclick="openPopup('images/case_01_big.jpg')">
                    <img src="images/case_01_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Landing Future Loan</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_02_big.jpg')">
                    <img src="images/case_02_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Car Insurance Website</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_03_big.jpg')">
                    <img src="images/case_03_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">UI Android Loan App</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_04_big.jpg')">
                    <img src="images/case_04_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Website of Marketing Agency</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_05_big.jpg')">
                    <img src="images/case_05_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Data Sender Portal</div>
                </div>

                <div class="case-container" onclick="openPopup('images/case_06_big.jpg')">
                    <img src="images/case_06_small.jpg" class="case-item">
                    <img src="images/img_shadow.png" class="case-shadow">
                    <div class="case-caption">Furniture website</div>
                </div>
            </div>
        </div>
    </main>

    <div id="popup" class="popup" onclick="closePopup()">
        <div class="popup-content">
            <img id="popup-img" src="" alt="Full size">
        </div>
    </div>

    <script>
        const slider = document.getElementById('scroll-container');
let isDown = false;
let startX;
let scrollLeft;
let isDragging = false; // Переменная-предохранитель

// Колесико мыши
slider.addEventListener('wheel', (evt) => {
    evt.preventDefault();
    slider.scrollLeft += evt.deltaY;
});

// Зажатие мышки
slider.addEventListener('mousedown', (e) => {
    isDown = true;
    isDragging = false; // Сбрасываем при каждом новом нажатии
    startX = e.pageX - slider.offsetLeft;
    scrollLeft = slider.scrollLeft;
    slider.style.cursor = 'grabbing';
    slider.style.userSelect = 'none';
});

slider.addEventListener('mouseleave', () => {
    isDown = false;
    slider.style.cursor = 'grab';
});

slider.addEventListener('mouseup', (e) => {
    isDown = false;
    slider.style.cursor = 'grab';
    slider.style.userSelect = 'auto';

    // Если мышь передвинулась во время нажатия — это был драг, блокируем клик
    if (isDragging) {
        // Чтобы предотвратить открытие попапа, мы можем использовать фазу захвата события
    }
});

slider.addEventListener('mousemove', (e) => {
    if (!isDown) return;
    
    const x = e.pageX - slider.offsetLeft;
    const walk = (x - startX) * 1;
    
    // Если сдвиг больше 5 пикселей, считаем это перетаскиванием
    if (Math.abs(x - startX) > 5) {
        isDragging = true;
    }

    if (isDragging) {
        e.preventDefault();
        slider.scrollLeft = scrollLeft - walk;
    }
});

// Новая функция обертка для открытия попапа
function handleCardClick(src) {
    // Открываем только если не было перетаскивания
    if (!isDragging) {
        openPopup(src);
    }
}

function openPopup(src) {
    const popup = document.getElementById('popup');
    const popupImg = document.getElementById('popup-img');

    // 1. Сначала убираем старую картинку
    popupImg.src = ''; 
    
    // 2. Устанавливаем новый путь
    popupImg.src = src;

    // 3. Показываем попап и сбрасываем скролл
    popup.style.display = 'flex';
    popup.scrollTop = 0;
}

function closePopup() {
    document.getElementById('popup').style.display = 'none';
}

// Предотвращаем стандартный drag картинок
slider.querySelectorAll('img').forEach(img => {
    img.addEventListener('dragstart', (e) => e.preventDefault());
});
    </script>
</body>
</html>
